#ifndef _TAP_DRIVER_H
#define _TAP_DRIVER_H

////////////////////////////////////////////////////////////////////////////////
//
// General functions.
//
////////////////////////////////////////////////////////////////////////////////

extern _BOOL InitializeTAPDriver();
extern void UninitializeTAPDriver();

////////////////////////////////////////////////////////////////////////////////
//
// TAP driver settings.
//
////////////////////////////////////////////////////////////////////////////////

extern void SetVirtualAddress(_STRING lpstrLocalIPAddress,_STRING lpstrLocalNetmask,_STRING lpstrRemoteIPAddress);
extern void SetL2TPServer(_STRING lpstrIPAddress,_UINT16 nPort);

////////////////////////////////////////////////////////////////////////////////
//
// TAP driver functions.
//
////////////////////////////////////////////////////////////////////////////////

extern _BOOL TAPDriverExists(_STRING lpstrAdapterName);

extern _BOOL OpenTAPDriver(_STRING lpstrAdapterName);
extern void CloseTAPDriver();

extern _BOOL OpenTAPDriverSocket();
extern void CloseTAPDriverSocket();

////////////////////////////////////////////////////////////////////////////////
//
// TAP driver status functions.
//
////////////////////////////////////////////////////////////////////////////////

extern _BOOL IsTAPDriverRunning();
extern _UINT32 GetTAPDriverInputSize();
extern _UINT32 GetTAPDriverOutputSize();

////////////////////////////////////////////////////////////////////////////////
//
// Log functions.
//
////////////////////////////////////////////////////////////////////////////////

extern void SetTAPDriverLog(_BOOL bLog);

////////////////////////////////////////////////////////////////////////////////

#endif //End of the head file !
